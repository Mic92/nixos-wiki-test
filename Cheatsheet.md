---
title: Cheatsheet
permalink: /Cheatsheet/
---

A cheat sheet and rough mapping between Ubuntu and NixOS
--------------------------------------------------------

This is meant to give you basic ideas and get you unstuck. NixOS is not meant to be used this way! Follow the links to the manual pages and browse the wiki to find real NixOS tutorials.

The system-wide column is the equivalent of using apt under Ubuntu.

| Task                                                            | Ubuntu                                                                                                                                        | NixOS (system-wide)                                                                                                                                                  | NixOS (user & root) and Nix in general                                                                                                                | Relevant section of the manual                                                   |
|-----------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
| Basic concepts                                                  |
|                                                                 |                                                                                                                                               | This column will let you do everything you can with Ubuntu.                                                                                                          |                                                                                                                                                       |                                                                                  |
|                                                                 | Who can install packages?                                                                                                                     | Root can install system-wide packages by placing them in /etc/nixos/configuration.nix                                                                                | Users and root can install their own packages through [~/.nixpkgs/config.nix](/#config_nix "wikilink")                                                | [Package management](https://nixos.org/nixos/manual/sec-package-management.html) |
|                                                                 | official sources, major releases                                                                                                              | a collection of channels, systemwide when set by root                                                                                                                | per-user otherwise                                                                                                                                    |                                                                                  |
| Package management                                              |
| Install a package                                               | `sudo apt-get install emacs`                                                                                                                  | In /etc/nixos/configuration.nix: If it's a program add to systemPackages:

                                                                                                                                                                                                                   ` systemPackages = with pkgs; [ `<other packages...>` emacs ];`

                                                                                                                                                                                                                   If it's a service add:

                                                                                                                                                                                                                   ` services.openssh.enable = true;`                                                                                                                                    | Add the package to your [~/.nixpkgs/config.nix](/#config_nix "wikilink") and run

                                                                                                                                                                                                                                                                                                                                                                                          ` nix-env -i all`                                                                                                                                      |
| Uninstall a package                                             | `sudo apt-get remove emacs`                                                                                                                   | remove from /etc/nixos/configuration.nix

                                                                                                                                                                                                                   ` sudo nixos-rebuild switch`                                                                                                                                          | Remove the package from your [~/.nixpkgs/config.nix](/#config_nix "wikilink") and run

                                                                                                                                                                                                                                                                                                                                                                                          ` nix-env -i all`                                                                                                                                      |
| Uninstall a package removing its configuration                  | `apt-get purge emacs`                                                                                                                         |                                                                                                                                                                      |                                                                                                                                                       |
| Update the list of packages                                     | `sudo apt-get update`                                                                                                                         | `sudo nix-channel --update`                                                                                                                                          | `nix-channel --update`

                                                                                                                                                                                                                                                                                                                                                                                          Note that root's channels are the global ones! Aside from this quirk root can maintain its own packages.                                               |
| Upgrade packages                                                | `sudo apt-get upgrade`                                                                                                                        | `sudo nixos-rebuild switch`                                                                                                                                          | `nix-env -u`                                                                                                                                          |
| Configure a package                                             | `sudo dpkg-reconfigure `<package>                                                                                                             | edit /etc/nixos/configuration.nix                                                                                                                                    | edit [~/.nixpkgs/config.nix](/#config_nix "wikilink") TODO More details about how to edit                                                             |
| Check for broken dependencies                                   | `sudo apt-get check`                                                                                                                          | unneeded!                                                                                                                                                            | unneeded!                                                                                                                                             |
| List package dependencies                                       | `apt-cache depends emacs`                                                                                                                     |                                                                                                                                                                      |                                                                                                                                                       |
| List which packages depend on this one (reverse dependencies)   | `apt-cache rdepends emacs`                                                                                                                    |                                                                                                                                                                      |                                                                                                                                                       |
| Verify all installed packages                                   | `debsums`                                                                                                                                     |                                                                                                                                                                      | `nix-store --verify`                                                                                                                                  |
| Select major version and stable/unstable                        | Change sources.list and apt-get dist-upgrade. A an extremely infrequent and destructive operation. The nix variants are safe and easy to use. | ` nix-channel --add `[`https://nixos.org/channels/nixpkgs-unstable`](https://nixos.org/channels/nixpkgs-unstable)` `<name>

                                                                                                                                                                                                                   Add the unstable channel. At that address you will find names for other versions and variants. Name can be any string.

                                                                                                                                                                                                                   ` nix-channel --remove `<name>

                                                                                                                                                                                                                   To eliminate a channel.

                                                                                                                                                                                                                   ` nix-channel --list`

                                                                                                                                                                                                                   To show all installed channel.                                                                                                                                        | When run by a user channels work locally, when run by root they're used as the system-wide channels.                                                  |
| Private package repository                                      | PPA                                                                                                                                           | Define your package tree as in the general column, and include it in configuration.nix, then list your packages in systemPackages to make them available system wide | see: [1](http://sandervanderburg.blogspot.com/2014/07/managing-private-nix-packages-outside.html)                                                     |
| Package information                                             |
| Find packages                                                   | `apt-cache search emacs`                                                                                                                      | `nix-env -qaP '.*emacs.*'`                                                                                                                                           | `nix-env -qaP '.*emacs.*'`                                                                                                                            |
| Show package description                                        | `apt-cache show emacs`                                                                                                                        | `nix-env -qa --description '.*emacs.*'`                                                                                                                              | `nix-env -qa --description '.*emacs.*'`                                                                                                               |
| Show files installed by package                                 | `dpkg -L emacs`                                                                                                                               | `tree /nix/store/*emacs*`                                                                                                                                            |                                                                                                                                                       |
| Services                                                        |
| Start a service                                                 | `sudo service apache start`                                                                                                                   | `sudo systemctl start apache`                                                                                                                                        |                                                                                                                                                       |
| Stop a service                                                  | `sudo service apache stop`                                                                                                                    | `sudo systemctl stop apache`                                                                                                                                         |                                                                                                                                                       |
| Misc tasks                                                      |
| List binaries                                                   | `ls /usr/bin/`                                                                                                                                | `ls /run/current-system/sw/bin`                                                                                                                                      | `ls ~/.nix-profile/bin`                                                                                                                               |
| Get the current version number                                  | `cat /etc/debian_version`                                                                                                                     | `nixos-version`                                                                                                                                                      | `nixos-version`                                                                                                                                       |
| Get sources for a package                                       | `apt-get source emacs; cd emacs*; dpkg buildpackage`                                                                                          |                                                                                                                                                                      | `"nix-shell emacs", then "unpackPhase; patchPhase"`                                                                                                   |
| Compile a package with the upstream source from version control |                                                                                                                                               |                                                                                                                                                                      | git clone foobar; echo 'with import <nixpkgs> { }; stdenv.lib.overrideDerivation foobar (oldAttrs : { src = ./foobar; })' &gt; default.nix; nix-build |

### Longer notes referenced above

#### <span id="config_nix">Skeleton ~/.nixpkgs/config.nix</span>

`{`
`  packageOverrides = pkgs_: with pkgs_; {`
`    all = with pkgs; buildEnv {`
`      name = "all";`
`      paths = [`
`        emacs`
`        file`
`        `<your other packages>
`      ];`
`    };`
`  };`
`}`

The idea is that all your packages will be accessible by one name "all" (it's just an arbitrary name). People call this a "collection", but it's referred to as any other package. Now you can update your entire per-user configuration in one go. The instructions above assume you have this kind of config.nix file.

You will see people telling you to run nix-env -i <package name>. Don't do it! It's evil!